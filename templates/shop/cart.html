{% extends 'base.html' %}

{% block title %}Votre Panier{% endblock %}

{% block header %}üõí Votre Panier{% endblock %}

{% block content %}
<h2>Contenu du panier</h2>

{% if user.is_authenticated %}
    <p><mark>‚úÖ Panier utilisateur connect√© (base de donn√©es)</mark></p>
{% else %}
    <p><mark>‚ö†Ô∏è Panier session (non connect√©)</mark></p>
{% endif %}

{% if cart_items %}
    <table>
        <thead>
            <tr>
                <th>Produit</th>
                <th>Prix unitaire</th>
                <th>Quantit√©</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart_items %}
                <tr>
                    {% if is_authenticated %}
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.product.price }} ‚Ç¨</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.get_total_price }} ‚Ç¨</td>
                    {% else %}
                        <td>{{ item.product_name }}</td>
                        <td>{{ item.price }} ‚Ç¨</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.total }} ‚Ç¨</td>
                    {% endif %}
                </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3"><strong>Total</strong></td>
                <td><strong>{{ total }} ‚Ç¨</strong></td>
            </tr>
        </tfoot>
    </table>
    
    <br>
    <a href="{% url 'index' %}" role="button">‚Üê Continuer mes achats</a>
{% else %}
    <p>Votre panier est vide.</p>
    <a href="{% url 'index' %}" role="button">Voir les produits</a>
{% endif %}

<br><br>
<details>
    <summary>‚ÑπÔ∏è Diff√©rence utilisateur connect√© / session</summary>
    <ul>
        <li><strong>Utilisateur connect√©:</strong> Panier sauvegard√© en DB, stock d√©cr√©ment√©</li>
        <li><strong>Session:</strong> Panier temporaire dans la session, stock non modifi√©</li>
    </ul>
</details>
{% endblock %}
